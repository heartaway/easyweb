<?xml version="1.0" encoding="GB2312"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">


<sqlMap>

	<typeAlias alias="Module" type="com.taobao.usp.domain.AppInfo" />
	<resultMap id="ModuleMap" class="Module">
		<result property="id" column="id" />
		<result property="title" column="title" />
		<result property="scope" column="scope" />
		<result property="owner" column="owner" />
		<result property="description" column="description" />
		<result property="gmtCreate" column="GMT_CREATE" jdbcType="DATETIME" />
		<result property="gmtModified" column="GMT_MODIFIED" jdbcType="DATETIME" />
	</resultMap>

	<sql id="moduleDAO.selectField">
		<![CDATA[
		SELECT id,title,scope,owner,description,GMT_CREATE,GMT_MODIFIED FROM usp_appinfo
		]]>
	</sql>

	<select id="moduleDAO.queryById" parameterClass="int" resultMap="ModuleMap">
		<include refid="moduleDAO.selectField" />
		<![CDATA[
			where id = #id#
		]]>
	</select>
	
	<select id="moduleDAO.queryAll" resultMap="ModuleMap">
		<include refid="moduleDAO.selectField" />
	</select>
    <select id="moduleDAO.queryByScope" resultMap="ModuleMap">
        <include refid="moduleDAO.selectField" />
        <![CDATA[
			where scope = #scope#
		]]>
    </select>


	<insert id="moduleDAO.insert" parameterClass="Module">
	    <![CDATA[
        INSERT INTO usp_appinfo
        ( 
          title,
          scope,
          owner,
          description,
          GMT_CREATE,
          GMT_MODIFIED
        ) VALUES (
          #title#,
          #scope#,
          #owner#,
          #description#,
		  now(),
		  now()
        )
         ]]>
	</insert>

    <update id="moduleDAO.update" parameterClass="Module">
        <![CDATA[
            update usp_appinfo set gmt_modified = now()
        ]]>
        <isNotNull prepend="," property="title">
            title = #title#
        </isNotNull>
        <isNotNull prepend="," property="scope">
            scope = #scope#
        </isNotNull>
        <isNotNull prepend="," property="description">
            description = #description#
        </isNotNull>
        <![CDATA[
            where id=#id#
        ]]>
    </update>

    <delete id="moduleDAO.delete" parameterClass="int">
        <![CDATA[
            delete from usp_appinfo where id = #id#
        ]]>
    </delete>

</sqlMap>