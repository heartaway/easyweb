<?xml version="1.0" encoding="GB2312"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">


<sqlMap>

	<typeAlias alias="AppInfo" type="com.taobao.easyweb.console.app.domain.AppInfo" />
	<resultMap id="AppInfoMap" class="AppInfo">
		<result property="id" column="id" />
		<result property="appName" column="app_name" />
		<result property="description" column="description" />
		<result property="svnurl" column="svnurl" />
		<result property="adminName" column="admin_name" />
		<result property="status" column="status" />
		<result property="gmtCreate" column="GMT_CREATE" jdbcType="DATETIME" />
		<result property="gmtModified" column="GMT_MODIFIED" jdbcType="DATETIME" />
	</resultMap>

	<sql id="appInfoDAO.selectField">
		<![CDATA[
		SELECT id,app_name,description,svnurl,admin_name,status,GMT_CREATE,GMT_MODIFIED FROM ew_console_app
		]]>
	</sql>

	<select id="appInfoDAO.queryById" parameterClass="int" resultMap="AppInfoMap">
		<include refid="appInfoDAO.selectField" />
		<![CDATA[
			where id = #id#
		]]>
	</select>
	
	<select id="appInfoDAO.queryByName" parameterClass="string" resultMap="AppInfoMap">
		<include refid="appInfoDAO.selectField" />
		<![CDATA[
			where app_name = #appName#
		]]>
	</select>
	<select id="appInfoDAO.queryAll" resultMap="AppInfoMap">
		<include refid="appInfoDAO.selectField" />
	</select>
	
	<select id="appInfoDAO.query" parameterClass="AppInfo" resultMap="AppInfoMap">
		<include refid="appInfoDAO.selectField" />
		<dynamic prepend="where">
			<isNotNull prepend="," property="name">
				name = #name#
			</isNotNull>
			<isNotNull prepend="," property="svnurl">
				svnurl = #svnurl#
			</isNotNull>
			<isNotNull prepend="," property="description">
				description = #description#
			</isNotNull>
			<isNotNull prepend="," property="adminName">
				admin_name = #adminName#
			</isNotNull>
			<isNotNull prepend="," property="status">
				status = #status#
			</isNotNull>
		</dynamic>
	</select>
	
	<update id="appInfoDAO.update" parameterClass="AppInfo">
		<![CDATA[
        	update ew_console_app set gmt_modified=now()
	 	]]>
		<isNotNull prepend="," property="name">
			name = #name#
		</isNotNull>
		<isNotNull prepend="," property="svnurl">
			svnurl = #svnurl#
		</isNotNull>
		<isNotNull prepend="," property="description">
			description = #description#
		</isNotNull>
		<isNotNull prepend="," property="adminName">
			admin_name = #adminName#
		</isNotNull>
		<isNotNull prepend="," property="status">
			status = #status#
		</isNotNull>
	 	<![CDATA[
	        WHERE ID = #id#
	 	]]>
	</update>

	<insert id="appInfoDAO.insert" parameterClass="AppInfo">
	    <![CDATA[
        INSERT INTO ew_console_app
        ( 
          app_name,
          description,
          svnurl,
          admin_name,
          status,
          GMT_CREATE,
          GMT_MODIFIED
        ) VALUES (
          #appName#,
          #description#,
          #svnurl#,
          #adminName#,
          #status#,
		  now(),
		  now()
        )
         ]]>
	</insert>

</sqlMap>